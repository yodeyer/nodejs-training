(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{373:function(e,t,n){"use strict";var r=n(1),o=n(0);t.a=o.a.extend({name:"measurable",props:{height:[Number,String],maxHeight:[Number,String],maxWidth:[Number,String],minHeight:[Number,String],minWidth:[Number,String],width:[Number,String]},computed:{measurableStyles:function(){var e={},t=Object(r.a)(this.height),n=Object(r.a)(this.minHeight),o=Object(r.a)(this.minWidth),c=Object(r.a)(this.maxHeight),l=Object(r.a)(this.maxWidth),d=Object(r.a)(this.width);return t&&(e.height=t),n&&(e.minHeight=n),o&&(e.minWidth=o),c&&(e.maxHeight=c),l&&(e.maxWidth=l),d&&(e.width=d),e}}})},374:function(e,t,n){"use strict";var r=n(0);t.a=r.a.extend({name:"v-card-title",functional:!0,props:{primaryTitle:Boolean},render:function(e,t){var data=t.data,n=t.props,r=t.children;return data.staticClass=("v-card__title "+(data.staticClass||"")).trim(),n.primaryTitle&&(data.staticClass+=" v-card__title--primary"),e("div",data,r)}})},375:function(e,t,n){"use strict";n(376),n(377);var r=n(9);var o=n(0).a.extend({name:"elevatable",props:{elevation:[Number,String]},computed:{computedElevation:function(){return this.elevation},elevationClasses:function(){return this.computedElevation?(e={},t="elevation-"+this.computedElevation,n=!0,t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e):{};var e,t,n}}}),c=n(373),l=n(7),d=n(3),h=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var t in source)Object.prototype.hasOwnProperty.call(source,t)&&(e[t]=source[t])}return e},v=Object(d.a)(r.a,o,c.a,l.a).extend({name:"v-sheet",props:{tag:{type:String,default:"div"},tile:Boolean},computed:{classes:function(){return h({"v-sheet":!0,"v-sheet--tile":this.tile},this.themeClasses,this.elevationClasses)},styles:function(){return this.measurableStyles}},render:function(e){var data={class:this.classes,style:this.styles,on:this.$listeners};return e(this.tag,this.setBackgroundColor(this.color,data),this.$slots.default)}}),m=n(41),f=Object.assign||function(e){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var t in source)Object.prototype.hasOwnProperty.call(source,t)&&(e[t]=source[t])}return e};t.a=Object(d.a)(m.a,v).extend({name:"v-card",props:{flat:Boolean,hover:Boolean,img:String,raised:Boolean},computed:{classes:function(){return f({"v-card":!0,"v-card--flat":this.flat,"v-card--hover":this.hover},v.options.computed.classes.call(this))},styles:function(){var style=f({},v.options.computed.styles.call(this));return this.img&&(style.background='url("'+this.img+'") center center / cover no-repeat'),style}},render:function(e){var t=this.generateRouteLink(this.classes),n=t.tag,data=t.data;return data.style=this.styles,e(n,this.setBackgroundColor(this.color,data),this.$slots.default)}})},376:function(e,t,n){},377:function(e,t,n){},378:function(e,t,n){},379:function(e,t,n){},380:function(e,t,n){},381:function(e,t,n){"use strict";n(117);var r=n(83);t.a=Object(r.a)("flex")},382:function(e,t,n){"use strict";n(117);var r=n(83);t.a=Object(r.a)("layout")},384:function(e,t,n){"use strict";var r=n(1),o=n(375),c=(n(378),n(379),n(373)),l=n(3),d=Object(l.a)(c.a).extend({name:"v-responsive",props:{aspectRatio:[String,Number]},computed:{computedAspectRatio:function(){return Number(this.aspectRatio)},aspectStyle:function(){return this.computedAspectRatio?{paddingBottom:1/this.computedAspectRatio*100+"%"}:void 0},__cachedSizer:function(){return this.aspectStyle?this.$createElement("div",{style:this.aspectStyle,staticClass:"v-responsive__sizer"}):[]}},methods:{genContent:function(){return this.$createElement("div",{staticClass:"v-responsive__content"},this.$slots.default)}},render:function(e){return e("div",{staticClass:"v-responsive",style:this.measurableStyles,on:this.$listeners},[this.__cachedSizer,this.genContent()])}}),h=n(6),v=d.extend({name:"v-img",props:{alt:String,contain:Boolean,src:{type:[String,Object],default:""},gradient:String,lazySrc:String,srcset:String,sizes:String,position:{type:String,default:"center center"},transition:{type:[Boolean,String],default:"fade-transition"}},data:function(){return{currentSrc:"",image:null,isLoading:!0,calculatedAspectRatio:void 0}},computed:{computedAspectRatio:function(){return this.normalisedSrc.aspect},normalisedSrc:function(){return"string"==typeof this.src?{src:this.src,srcset:this.srcset,lazySrc:this.lazySrc,aspect:Number(this.aspectRatio||this.calculatedAspectRatio)}:{src:this.src.src,srcset:this.srcset||this.src.srcset,lazySrc:this.lazySrc||this.src.lazySrc,aspect:Number(this.aspectRatio||this.src.aspect||this.calculatedAspectRatio)}},__cachedImage:function(){if(!this.normalisedSrc.src&&!this.normalisedSrc.lazySrc)return[];var e=[],t=this.isLoading?this.normalisedSrc.lazySrc:this.currentSrc;this.gradient&&e.push("linear-gradient("+this.gradient+")"),t&&e.push('url("'+t+'")');var image=this.$createElement("div",{staticClass:"v-image__image",class:{"v-image__image--preload":this.isLoading,"v-image__image--contain":this.contain,"v-image__image--cover":!this.contain},style:{backgroundImage:e.join(", "),backgroundPosition:this.position},key:+this.isLoading});return this.transition?this.$createElement("transition",{attrs:{name:this.transition,mode:"in-out"}},[image]):image}},watch:{src:function(){this.isLoading?this.loadImage():this.init()},"$vuetify.breakpoint.width":"getSrc"},mounted:function(){this.init()},methods:{init:function(){if(this.normalisedSrc.lazySrc){var e=new Image;e.src=this.normalisedSrc.lazySrc,this.pollForSize(e,null)}this.normalisedSrc.src&&this.loadImage()},onLoad:function(){this.getSrc(),this.isLoading=!1,this.$emit("load",this.src)},onError:function(){Object(h.a)("Image load failed\n\nsrc: "+this.normalisedSrc.src,this),this.$emit("error",this.src)},getSrc:function(){this.image&&(this.currentSrc=this.image.currentSrc||this.image.src)},loadImage:function(){var e=this,image=new Image;this.image=image,image.onload=function(){image.decode?image.decode().catch(function(t){Object(h.b)("Failed to decode image, trying to render anyway\n\nsrc: "+e.normalisedSrc.src+(t.message?"\nOriginal error: "+t.message:""),e)}).then(e.onLoad):e.onLoad()},image.onerror=this.onError,image.src=this.normalisedSrc.src,this.sizes&&(image.sizes=this.sizes),this.normalisedSrc.srcset&&(image.srcset=this.normalisedSrc.srcset),this.aspectRatio||this.pollForSize(image),this.getSrc()},pollForSize:function(img){var e=this,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;!function n(){var r=img.naturalHeight,o=img.naturalWidth;r||o?e.calculatedAspectRatio=o/r:null!=t&&setTimeout(n,t)}()},__genPlaceholder:function(){if(this.$slots.placeholder){var e=this.isLoading?[this.$createElement("div",{staticClass:"v-image__placeholder"},this.$slots.placeholder)]:[];return this.transition?this.$createElement("transition",{attrs:{name:this.transition}},e):e[0]}}},render:function(e){var t=d.options.render.call(this,e);return t.data.staticClass+=" v-image",t.data.attrs={role:this.alt?"img":void 0,"aria-label":this.alt},t.children=[this.__cachedSizer,this.__cachedImage,this.__genPlaceholder(),this.genContent()],e(t.tag,t.data,t.children)}}).extend({name:"v-card-media",mounted:function(){Object(h.c)("v-card-media",this.src?"v-img":"v-responsive",this)}}),m=n(374);n.d(t,"a",function(){return _});var f=Object(r.c)("v-card__actions"),_=Object(r.c)("v-card__text");o.a,m.a},385:function(e,t,n){"use strict";n(380);var r=n(42),o=n(9),c=n(24),l=n(0).a.extend({name:"transitionable",props:{mode:String,origin:String,transition:String}}),d=n(3);t.a=Object(d.a)(o.a,c.a,l).extend({name:"v-alert",props:{dismissible:Boolean,icon:String,outline:Boolean,type:{type:String,validator:function(e){return["info","error","success","warning"].includes(e)}}},computed:{computedColor:function(){return this.type&&!this.color?this.type:this.color||"error"},computedIcon:function(){if(this.icon||!this.type)return this.icon;switch(this.type){case"info":return"$vuetify.icons.info";case"error":return"$vuetify.icons.error";case"success":return"$vuetify.icons.success";case"warning":return"$vuetify.icons.warning"}}},methods:{genIcon:function(){return this.computedIcon?this.$createElement(r.a,{class:"v-alert__icon"},this.computedIcon):null},genDismissible:function(){var e=this;return this.dismissible?this.$createElement("a",{class:"v-alert__dismissible",on:{click:function(){e.isActive=!1}}},[this.$createElement(r.a,{props:{right:!0}},"$vuetify.icons.cancel")]):null}},render:function(e){var t=[this.genIcon(),e("div",this.$slots.default),this.genDismissible()],n=e("div",(this.outline?this.setTextColor:this.setBackgroundColor)(this.computedColor,{staticClass:"v-alert",class:{"v-alert--outline":this.outline},directives:[{name:"show",value:this.isActive}],on:this.$listeners}),t);return this.transition?e("transition",{props:{name:this.transition,origin:this.origin,mode:this.mode}},[n]):n}})},404:function(e,t,n){e.exports=n.p+"videos/4052ee7.mp4"},426:function(e,t,n){"use strict";n.r(t);var r={data:function(){return{isVisible:!1}}},o=n(23),c={components:{ShowHide:Object(o.a)(r,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",[n("a",{directives:[{name:"show",rawName:"v-show",value:e.isVisible,expression:"isVisible"}],on:{click:function(t){e.isVisible=!1}}},[e._v("Masquer")]),e._v(" "),n("a",{directives:[{name:"show",rawName:"v-show",value:!e.isVisible,expression:"!isVisible"}],on:{click:function(t){e.isVisible=!0}}},[e._v("Afficher")])]),e._v(" "),e.isVisible?e._t("default"):e._e()],2)},[],!1,null,null,null).exports}},l=n(84),d=n.n(l),h=n(385),v=n(375),m=n(384),f=n(374),_=n(381),y=n(382),S=Object(o.a)(c,function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-layout",{attrs:{column:"","justify-center":"","align-center":""}},[r("v-flex",{attrs:{xs12:"",sm8:"",md6:""}},[r("v-card",[r("v-card-title",{staticClass:"headline primary--text"},[e._v("Comment fonctionne l'asynchronisme en Node.js ?")]),e._v(" "),r("v-card-text",[r("v-card-title",{staticClass:"subheading primary--text"},[e._v("Rappel")]),e._v(" "),r("p",[e._v("\n            Node.js est composé :\n            "),r("ul",[r("li",[e._v("de V8, qui un moteur Javascript : c'est lui qui va s'occuper d'exécuter notre code Javascript ;")]),e._v(" "),r("li",[e._v("de libuv, qui est une librairie permettant de gérer les entrées / sorties via des évènements.")])])]),e._v(" "),r("v-card-title",{staticClass:"subheading primary--text"},[e._v("Que se passe t'il quand on appelle une fonction asynchrone ?")]),e._v(" "),r("p",[e._v("\n            Pour expliquer le fonctionnement, le mieux est de partir d'un exemple :\n            "),r("pre",{directives:[{name:"highlightjs",rawName:"v-highlightjs"}]},[r("code",{attrs:{language:"javascript"}},[e._v("\n  fs.readdir(__dirname, (err, dirs) => {\n    console.log('le callback est appelé');\n  });\n  console.log('fin du fichier');")])])]),e._v(" "),r("p",[e._v("\n            Dans le code ci-dessus, dans l'ordre :\n            "),r("ol",[r("li",[e._v("V8 exécute la ligne "),r("code",[e._v("fs.readdir")]),e._v(" : Node.js va déléguer la lecture du dossier à libuv, en lui fournissant également le callback associé ;")]),e._v(" "),r("li",[e._v('V8 continue l\'exécution du code Javascript et affiche "fin du fichier" ;')]),e._v(" "),r("li",[e._v("quelques instants plus tard, quand le lecture fichier sera terminée, libuv va recevoir une évènement qui sera mis dans une file d'attente ;")]),e._v(" "),r("li",[e._v("quand il n'y aura plus de code JS en cours d'exécution, libuv va dépiler les files d'attente et exécuter les callbacks présents associés.")])])]),e._v(" "),r("p",[e._v("\n            La même explication en vidéo :\n            "),r("show-hide",[r("video",{attrs:{controls:""}},[r("source",{attrs:{src:n(404),type:"video/mp4"}})])])],1),e._v(" "),r("v-card-title",{staticClass:"subheading primary--text"},[e._v("L'event loop")]),e._v(" "),r("p",[e._v("\n            Il faut noter que libuv ne dispose pas d'une, mais de plusieurs files d'attente (suivant le type d'opération asynchrone) qui sont dépilées dans un ordre bien défini. C'est ce qu'on appelle l'event loop."),r("pre",[e._v("   ┌───────────────────────┐\n┌─>│        timers         │<───── setTimeout, setInterval...\n│  └──────────┬────────────┘\n│  ┌──────────┴────────────┐\n│  │     I/O callbacks     │\n│  └──────────┬────────────┘\n│  ┌──────────┴────────────┐\n│  │     idle, prepare     │\n│  └──────────┬────────────┘      ┌───────────────┐\n│  ┌──────────┴────────────┐      │   incoming:   │\n│  │         poll          │<─────┤  connections, │\n│  └──────────┬────────────┘      │   data, etc.  │\n│  ┌──────────┴────────────┐      └───────────────┘\n│  │        check          │<───── setImmediate\n│  └──────────┬────────────┘\n│  ┌──────────┴────────────┐\n└──┤    close callbacks    │\n   └───────────────────────┘\n")])]),e._v(" "),r("v-alert",{attrs:{value:!0,color:"info",icon:"info",outline:""}},[e._v("\n            De ce fonctionnement, il faut retenir que :\n            "),r("ul",[r("li",[e._v("le code Javascript en cours d'exécution ne sera jamais interrompu par un callback ;")]),e._v(" "),r("li",[e._v("la pile d'exécution d'un callback repart de zéro, car le callback est appelé par libuv, pas par la fonction asynchrone ;")]),e._v(" "),r("li",[e._v("une exception levée dans un callback ne peut-être catchée par un "),r("code",[e._v("try/catch")]),e._v(" autour de la fonction asynchrone, et par défaut provoquera l'arrêt du processus Node.js ;")]),e._v(" "),r("li",[e._v("deux évènements de types différents peuvent ne pas être traitées dans l'ordre où ils sont arrivés ;")]),e._v(" "),r("li",[e._v("il est important de ne pas bloquer l'event loop (par un traitement synchrone par exemple), car cela bloquera l'exécution des autres évènements.")])])]),e._v(" "),r("p",[e._v("\n            Enfin, pour éviter de bloquer trop longtemps l'event loop avec une opération consommatrice en CPU, Node.JS propose deux méthodes permettant de différer un traitement à plus tard :\n            "),r("ul",[r("li",[r("a",{attrs:{href:"https://nodejs.org/api/timers.html#timers_setimmediate_callback_args"}},[e._v("setImmediate()")]),e._v(" permet de reporter un traitement à l'étape \"check\" de l'event loop ;")]),e._v(" "),r("li",[r("a",{attrs:{href:"https://nodejs.org/api/process.html#process_process_nexttick_callback_args"}},[e._v("process.nextTick()")]),e._v(" permet de reporter un traitement à la fin de la file d'attente en cours d'exécution.")])]),e._v("\n            Plus d'informations sur l'event loop : "),r("a",{attrs:{href:"https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/"}},[e._v("https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/")]),e._v(".\n          ")])],1)],1)],1)],1)},[],!1,null,null,null);t.default=S.exports;d()(S,{VAlert:h.a,VCard:v.a,VCardText:m.a,VCardTitle:f.a,VFlex:_.a,VLayout:y.a})}}]);